(require 'package)

(add-to-list 'package-archives
             '("melpa" . "https://melpa.org/packages/") t)

(package-initialize)
;; (package-refresh-contents)

;; Download packages
(unless (package-installed-p 'evil)            ;; vim binding support
  (package-install 'evil))
(unless (package-installed-p 'elm-mode)        ;; elm lang support <3
  (package-install 'elm-mode))
(unless (package-installed-p 'lsp-java)        ;; java support
  (package-install 'lsp-java))
(unless (package-installed-p 'undo-fu)         ;; redo for evil
  (package-install 'undo-fu))
(unless (package-installed-p 'magit)           ;; git client
  (package-install 'magit))
(unless (package-installed-p 'evil-collection) ;; without this, magit does not play well with evil mode
  (package-install 'evil-collection))
(unless (package-installed-p 'elfeed)          ;; rss client
  (package-install 'elfeed))
(unless (package-installed-p 'neotree)         ;; file tree
  (package-install 'neotree))
(unless (package-installed-p 'markdown-mode)   ;; better markdown support
  (package-install 'markdown-mode))
(unless (package-installed-p 'which-key)       ;; minor mode that displays key bindings
  (package-install 'which-key))
(unless (package-installed-p 'ag)              ;; search using ag
  (package-install 'ag))
;; Autocomplete and project management related
(unless (package-installed-p 'projectile)
  (package-install 'projectile))
(unless (package-installed-p 'lsp-mode)
  (package-install 'lsp-mode))
(unless (package-installed-p 'lsp-ui)
  (package-install 'lsp-ui))
(unless (package-installed-p 'flycheck)
  (package-install 'flycheck))
(unless (package-installed-p 'company)
  (package-install 'company))
(unless (package-installed-p 'helm-lsp)
  (package-install 'helm-lsp))

;; Enable evil and evil collection
(setq evil-want-keybinding nil)
(setq evil-undo-system 'undo-fu)
(require 'evil)
(evil-mode 1)
(when (require 'evil-collection nil t)
  (evil-collection-init))

;; Custom variables
(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(blink-cursor-mode nil)
 '(custom-enabled-themes (quote (tango-dark)))
 '(helm-minibuffer-history-key "M-p")
 '(inhibit-startup-screen t)
 '(menu-bar-mode nil)
 '(package-selected-packages (quote (## lsp-javacomp magit evil)))
 '(tool-bar-mode nil))
(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 )

;; Configuring general lsp support
(require 'lsp-mode)
(setq lsp-enable-links nil)

;; Configuring lsp Elm
(add-hook 'elm-mode-hook 'elm-format-on-save-mode)
(add-hook 'elm-mode-hook #'lsp)

;; Configuring lsp Java
(require 'lsp-java)
(add-hook 'java-mode-hook #'lsp)

;; Enbales which-key (https://github.com/justbur/emacs-which-key)
(which-key-mode)

;; Neotree shortcut
(global-set-key (kbd "C-x t") 'neotree-toggle)

;; Show line number
(global-display-line-numbers-mode)

;; RSS Feeds
(setq elfeed-feeds
      '("http://feeds.macrumors.com/MacRumors-All"
        "https://www.davefarley.net/?feed=rss"
        "https://thoughtworks.libsyn.com/rss"
        "https://www.martinfowler.com/bliki/bliki.atom"
        "https://feed.infoq.com"
        "https://segunda.tech/rss.xml"))
